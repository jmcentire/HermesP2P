<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HermesP2P â€” Safe. Secure. Sovereign.</title>
    <meta name="description" content="Decentralized, ephemeral peer-to-peer messaging. No servers, no persistence, no compromise.">
    <link rel="icon" type="image/pdf" href="{{ url_for('static', filename='images/favicon.pdf') }}">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, Helvetica, sans-serif;
            background: #ffffff;
            color: #333;
            line-height: 1.6;
        }
        a { color: #000033; text-decoration: none; }
        a:hover { text-decoration: underline; }

        /* Hero */
        .hero {
            text-align: center;
            padding: 48px 24px 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        .hero img { height: 120px; margin-bottom: 16px; }
        .hero h1 {
            font-size: 2.4rem;
            color: #000033;
            letter-spacing: -0.02em;
            margin-bottom: 4px;
        }
        .hero .tagline {
            font-size: 1.2rem;
            font-style: italic;
            color: #6c757d;
            margin-bottom: 16px;
        }
        .hero .subtitle {
            font-size: 1.05rem;
            color: #555;
            max-width: 600px;
            margin: 0 auto 28px;
        }
        .cta-group {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 8px;
        }
        .btn {
            display: inline-block;
            padding: 10px 24px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            border: none;
            transition: background 0.15s ease;
        }
        .btn-primary {
            background: #000033;
            color: #fff !important;
        }
        .btn-primary:hover {
            background: #000055;
            text-decoration: none;
        }
        .btn-secondary {
            background: #e9ecef;
            color: #000033 !important;
            border: 1px solid #ced4da;
        }
        .btn-secondary:hover {
            background: #dee2e6;
            text-decoration: none;
        }

        /* Sections */
        .section {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 24px 48px;
        }
        .section h2 {
            font-size: 1.5rem;
            color: #000033;
            margin-bottom: 16px;
            padding-top: 32px;
            border-top: 1px solid #e9ecef;
        }
        .section h2:first-child { border-top: none; padding-top: 0; }
        .section p {
            color: #555;
            font-size: 1rem;
            margin-bottom: 12px;
        }

        /* Feature grid */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
        }
        .feature-card h3 {
            font-size: 1rem;
            color: #000033;
            margin-bottom: 6px;
        }
        .feature-card p {
            font-size: 0.9rem;
            color: #6c757d;
            margin: 0;
        }

        /* Protocol features */
        .protocol-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin: 20px 0;
        }
        .protocol-item {
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }
        .protocol-num {
            flex-shrink: 0;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #000033;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
        }
        .protocol-item h4 {
            font-size: 0.95rem;
            color: #000033;
            margin-bottom: 2px;
        }
        .protocol-item p {
            font-size: 0.9rem;
            color: #6c757d;
            margin: 0;
        }

        /* Auth box */
        .auth-box {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 24px;
            margin: 20px 0;
            font-family: 'SF Mono', 'Fira Code', Menlo, Consolas, monospace;
            font-size: 0.85rem;
            line-height: 1.8;
            color: #6c757d;
        }
        .auth-box .label { color: #000033; font-weight: 600; }
        .auth-box .arrow { color: #000033; }

        /* Upload status */
        .alert { padding: 12px 16px; border-radius: 6px; margin-top: 12px; font-size: 0.95rem; }
        .alert-info { background: #e7f3ff; color: #0c5460; }
        .alert-success { background: #d4edda; color: #155724; }
        .alert-danger { background: #f8d7da; color: #721c24; }
        .d-none { display: none; }

        /* Support */
        .support-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin: 16px 0;
        }
        .support-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
        }
        .support-card h4 {
            font-size: 0.95rem;
            color: #000033;
            margin-bottom: 8px;
        }
        .support-card small {
            word-break: break-all;
            color: #6c757d;
            font-size: 0.8rem;
        }

        /* Book */
        .book-box {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 28px;
            text-align: center;
            margin: 20px 0;
        }
        .book-box h3 {
            font-size: 1.1rem;
            color: #000033;
            margin-bottom: 8px;
        }
        .book-box p {
            color: #6c757d;
            font-size: 0.95rem;
            max-width: 500px;
            margin: 0 auto 16px;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 24px;
            color: #6c757d;
            font-size: 0.85rem;
            border-top: 1px solid #e9ecef;
            max-width: 800px;
            margin: 0 auto;
        }

        @media (max-width: 768px) {
            .hero h1 { font-size: 1.8rem; }
            .feature-grid { grid-template-columns: 1fr; }
            .protocol-grid { grid-template-columns: 1fr; }
            .support-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<section class="hero">
    <img src="{{ url_for('static', filename='images/hermesp2p.png') }}" alt="HermesP2P Logo">
    <h1>HermesP2P</h1>
    <p class="tagline">Safe. Secure. Sovereign.</p>
    <p class="subtitle">
        Decentralized, ephemeral peer-to-peer messaging.
        No servers store your messages. No accounts to breach.
        Your config file is your identity &mdash; upload it and you're you.
    </p>
    <div class="cta-group">
        <input type="file" id="configFile" accept=".json" style="display:none">
        <button onclick="document.getElementById('configFile').click()" class="btn btn-secondary">Upload Config</button>
        <a href="{{ url_for('client') }}" class="btn btn-primary">New Identity</a>
    </div>
    <div id="uploadStatus" class="alert d-none"></div>
</section>

<div class="section">
    <h2>Three Principles</h2>
    <div class="feature-grid">
        <div class="feature-card">
            <h3>Ephemeral</h3>
            <p>Messages are transient. They exist in memory during transit and are never persisted. No server stores your history. No database to subpoena.</p>
        </div>
        <div class="feature-card">
            <h3>Decentralized</h3>
            <p>No central servers, no authority, no single point of failure. Every node contributes to resilience. The network self-organizes.</p>
        </div>
        <div class="feature-card">
            <h3>Sovereign</h3>
            <p>Your Ed25519 keypair is your identity. Private keys never leave your device. No passwords, no accounts, no third-party authentication.</p>
        </div>
    </div>
</div>

<div class="section">
    <h2>Stateless Authentication</h2>
    <p>
        There are no accounts. No passwords. No sessions stored on a server.
        <strong>Your configuration file IS your identity.</strong>
        It contains your keypair, your channels, your contacts' public keys, and your peer list.
        Upload it to any node and you're authenticated. Download it when you leave. The node forgets you existed.
    </p>
    <div class="auth-box">
        <div><span class="label">Config File</span></div>
        <div>&nbsp; <span class="arrow">+--</span> <span class="label">keypair</span>: Ed25519 public/private keys</div>
        <div>&nbsp; <span class="arrow">+--</span> <span class="label">channels</span>: subscribed public &amp; private topics</div>
        <div>&nbsp; <span class="arrow">+--</span> <span class="label">friends</span>: contacts' public keys</div>
        <div>&nbsp; <span class="arrow">+--</span> <span class="label">peers</span>: known network nodes</div>
        <div>&nbsp;</div>
        <div><span class="arrow">&gt;</span> Upload to any node = authenticated</div>
        <div><span class="arrow">&gt;</span> Download when done = node forgets you</div>
        <div><span class="arrow">&gt;</span> No server state. No breach surface.</div>
    </div>
</div>

<div class="section">
    <h2>Protocol Features</h2>
    <div class="protocol-grid">
        <div class="protocol-item">
            <div class="protocol-num">1</div>
            <div>
                <h4>Ed25519 Signatures</h4>
                <p>Every message is signed. Every signature is verified at every hop. No impersonation possible.</p>
            </div>
        </div>
        <div class="protocol-item">
            <div class="protocol-num">2</div>
            <div>
                <h4>Fixed-Size Padding</h4>
                <p>Messages are padded to fixed sizes (1KB/4KB/16KB/64KB) to prevent traffic analysis. Observers can't distinguish message types by size.</p>
            </div>
        </div>
        <div class="protocol-item">
            <div class="protocol-num">3</div>
            <div>
                <h4>TTL Hop Control</h4>
                <p>Time-to-live counters control message propagation depth. Messages spread through the network efficiently without flooding.</p>
            </div>
        </div>
        <div class="protocol-item">
            <div class="protocol-num">4</div>
            <div>
                <h4>Peer Discovery</h4>
                <p>Nodes discover peers and build diverse connection graphs automatically. The network adapts and self-heals.</p>
            </div>
        </div>
        <div class="protocol-item">
            <div class="protocol-num">5</div>
            <div>
                <h4>Pseudonyms</h4>
                <p>Channel-specific pseudonyms let you participate in public channels without revealing your global identity.</p>
            </div>
        </div>
        <div class="protocol-item">
            <div class="protocol-num">6</div>
            <div>
                <h4>Encrypted Channels</h4>
                <p>Private channels use AES-256 symmetric keys. Public channels are open. Direct messages are encrypted to the recipient's public key.</p>
            </div>
        </div>
    </div>
</div>

<div class="section">
    <h2>Getting Started</h2>
    <p>Two options to join the network:</p>
    <p>
        <strong>Upload your config</strong> &mdash; already have a keypair? Upload your configuration file to rejoin your channels and contacts instantly.
    </p>
    <p>
        <strong>Create a new identity</strong> &mdash; generate a fresh Ed25519 keypair and subscribe to default channels. Your keys are created locally and never touch a server.
    </p>
    <div class="cta-group" style="margin-top: 20px;">
        <button onclick="document.getElementById('configFile').click()" class="btn btn-secondary">Upload Config</button>
        <a href="{{ url_for('client') }}" class="btn btn-primary">New Identity</a>
    </div>
    <p style="margin-top: 20px;">
        Want to run your own node? Clone the repo and start contributing to network resilience:
    </p>
    <div class="auth-box" style="margin-bottom: 0;">
        <div>git clone https://github.com/jmcentire/HermesP2P.git</div>
        <div>cd HermesP2P && npm install && npm run start</div>
    </div>
</div>

<div class="section">
    <h2>Learn More</h2>
    <div class="book-box">
        <h3>Built on the ideas in <em>Privacy</em></h3>
        <p>
            The theoretical foundation behind HermesP2P's design decisions around ephemeral communication,
            key sovereignty, and decentralized trust.
        </p>
        <a href="https://a.co/d/05PSJFBK" class="btn btn-secondary" style="margin-right: 8px;">Read the Book</a>
        <a href="https://github.com/jmcentire/HermesP2P" class="btn btn-primary">View on GitHub</a>
    </div>
    <div style="text-align: center; margin-top: 16px;">
        <a href="https://docs.google.com/presentation/d/1xYhkXgVJ6M-QtQr5NqtQpqmQN9M7kQOD8_eBW3R3yZY/edit?usp=sharing"
           target="_blank" style="color: #6c757d; font-size: 0.9rem;">
            View Presentation Deck
        </a>
    </div>
</div>

<div class="section">
    <h2>Support the Project</h2>
    <p>HermesP2P is open source. Your support helps maintain and improve the platform.</p>
    <div class="support-grid">
        <div class="support-card">
            <h4>Bitcoin (BTC)</h4>
            <small>bc1qz5s4fx5kwj7cnhujpeg3z56f40lf2mwdzu2gfr</small>
        </div>
        <div class="support-card">
            <h4>Ethereum (ETH)</h4>
            <small>0x81d2884b970b6F96004Fbed0a593be7D22Bb46AA</small>
        </div>
        <div class="support-card">
            <h4>Nano</h4>
            <small>nano_3rq9q17s111bq41kmochax4wexarzsemo3kmzxiqrenhbju93jdm77fhza4f</small>
        </div>
    </div>
</div>

<footer>
    <p>HermesP2P &middot; <a href="https://github.com/jmcentire/HermesP2P">GitHub</a> &middot; <a href="https://a.co/d/05PSJFBK">Privacy (Book)</a> &middot; <a href="mailto:contact@hp2p.net">contact@hp2p.net</a></p>
</footer>

<script>
    document.getElementById('configFile').addEventListener('change', async function(e) {
        const file = e.target.files[0];
        if (!file) return;

        const statusDiv = document.getElementById('uploadStatus');
        statusDiv.className = 'alert alert-info';
        statusDiv.textContent = 'Validating configuration...';
        statusDiv.classList.remove('d-none');

        const formData = new FormData();
        formData.append('config', file);

        try {
            const response = await fetch('/validate-config', {
                method: 'POST',
                body: formData
            });

            const result = await response.json();

            if (response.ok) {
                statusDiv.className = 'alert alert-success';
                statusDiv.textContent = 'Configuration valid! Redirecting to client...';
                sessionStorage.setItem('hp2pConfig', JSON.stringify(result.config));
                setTimeout(() => {
                    window.location.href = "{{ url_for('client') }}";
                }, 1500);
            } else {
                statusDiv.className = 'alert alert-danger';
                statusDiv.textContent = 'Error: ' + result.error;
            }
        } catch (error) {
            statusDiv.className = 'alert alert-danger';
            statusDiv.textContent = 'Error uploading configuration: ' + error.message;
        }
    });
</script>

</body>
</html>
